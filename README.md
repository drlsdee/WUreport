# WUreport

## Preamble
Необходимо решить задачу контроля и мониторинга обновления пользовательских рабочих станций (PC) и терминальных машин. Предполагается, что учётная запись, под которой будет решаться задача, имеет права администратора на целевых PC и WSUS, а также возможно создание групповой политики AD.
Задача разбита на 3 части которые можно решать по отдельности или вместе.

## Tasklist
1.  Сбор информации
    1. получить из ветки AD список PC;
    2. сформировать отчёт, который будет включать в себя:
        1. имя PC;
        2. имена пользователей;
        3. дату последнего установленного обновления;
        4. кол-во доступных для установки обновлений;
        5. статус "Pending for reboot" если обновления установлены и ожидается перезагрузка;
        6. адрес WSUS сервера;
        7. дата последней синхронизации с WSUS.

2. Уведомление пользователей и контроль:
    1. если на PC доступны обновления для установки, необходимо, в рабочее время, вывести пользователю всплывающее окно с сообщением вида «Необходимо выполнить установку критических обновлений и обновлений безопасности»;
    2. если на PC установлены обновления в состоянии "Pending for reboot" , необходимо, в рабочее время, вывести пользователю всплывающее окно с сообщением вида "для завершения установки обновлений";
    3. если пользователь в течении 3-х рабочих дней не выполнил установку и перезагрузку, то должно появиться сообщение с указанием даты установки обновлений и перезагрузки в автоматическом режиме;
    4. количество таких сообщений желательно добавить в отчёт.

3. Автоматический ребут:
    1. выполнить перезагрузку PC в состоянии "Pending for reboot" при просрочке перезагрузки более 3-х дней;
    2. необходимо выполнить автоматическую установку при просрочке более 3-х дней.

## Conclusion
На выходе хотелось бы видеть один или несколько PowerShell скриптов/модулей которые позволяют решить задачу полностью или частично. Групповую политику можно описать отдельно. Комментарии будут плюсом.
